<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Hillary — September 2025</title>
  <style>
    body { font-family: -apple-system, system-ui, sans-serif; line-height: 1.45; margin: 24px; }
    header { display:flex; align-items:center; gap:16px; margin-bottom:16px; flex-wrap: wrap; }
    .row { display:flex; align-items:center; gap:8px; margin:6px 0; flex-wrap: wrap; }
    .card { border:1px solid #ddd; border-radius:12px; padding:12px 14px; margin:12px 0; }
    .small { color:#777; font-size: 12px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; }
    audio { width: 320px; }
    select { padding:6px 8px; border-radius:8px; border:1px solid #ccc; }
  </style>
</head>
<body>
  <header>
    <h1>Hillary — September 2025</h1>
    <div class="row">
      <label for="episodeFilter">Filter by episode:</label>
      <select id="episodeFilter"><option value="">All</option></select>
    </div>
    <div class="small">Portable read-only page. Share this folder as-is (keep <span class="mono">clips/</span> with it).</div>
  </header>
  <div id="hits"></div>

<script id="payload" type="application/json">[{"episode": "25-09-04", "episode_pretty": "September 4", "start": 3617.548, "end": 3621.213, "text": "Uh, the subject line is why Hillary lost submission?", "speaker_id": "SPEAKER_08", "speaker": "DAN", "clip": "clips/25-09-04_hillary_001.mp3"}, {"episode": "25-09-04", "episode_pretty": "September 4", "start": 3653.973, "end": 3662.787, "text": "He said, I know he's your boy, Jake, but guys like George calling Dave Portnoy on big noon Fox gross and how it's disgusting that he's a thought leader is why Hillary lost.", "speaker_id": "SPEAKER_08", "speaker": "DAN", "clip": "clips/25-09-04_hillary_002.mp3"}, {"episode": "25-09-15", "episode_pretty": "September 15", "start": 8776.087, "end": 8777.851, "text": "Like, yeah, Hillary and Bill, they're bad.", "speaker_id": "SPEAKER_06", "speaker": "DAN", "clip": "clips/25-09-15_hillary_001.mp3"}, {"episode": "25-09-16", "episode_pretty": "September 16", "start": 5096.996, "end": 5116.298, "text": "Yes, and he spoke to you on that account Right and he was up for the Hall of Fame and it was 16 because I remember I'm not sure was as late as December because maybe it was because we were talking about the election a little bit and whether he was voting for Hillary because she was in Arkansas or Trump because", "speaker_id": "SPEAKER_06", "speaker": "BALDIE", "clip": "clips/25-09-16_hillary_001.mp3"}]</script>
<script>
let data = [];
try {
  data = JSON.parse(document.getElementById('payload').textContent);
  if (!Array.isArray(data)) data = [];
} catch (e) {
  const pre = document.createElement('pre');
  pre.textContent = 'JSON parse error: ' + e.message;
  pre.style.color = 'crimson';
  document.body.insertBefore(pre, document.body.firstChild);
}

function render() {
  const container = document.getElementById('hits');
  const select = document.getElementById('episodeFilter');
  if (!select.dataset.init) {
    const episodes = Array.from(new Set(data.map(d => d.episode))).sort();
    episodes.forEach(ep => { const opt = document.createElement('option'); opt.value = ep; opt.textContent = ep; select.appendChild(opt); });
    select.dataset.init = "1";
    select.onchange = () => render();
  }
  container.innerHTML = '';
  const filterEp = select.value || '';
  const items = filterEp ? data.filter(d => d.episode === filterEp) : data;
  if (!items.length) {
    const d = document.createElement('div'); d.className = 'small'; d.textContent = 'No matches.'; container.appendChild(d); return;
  }
  items.forEach((item, idx) => {
    const card = document.createElement('div'); card.className = 'card';
    const title = document.createElement('div'); title.className = 'row';
    const left = document.createElement('div');
    left.innerHTML = '<strong>#' + (idx+1) + '</strong> ' +
                     '<span class="small">(episode: ' + (item.episode || '?') +
                     ', speaker: ' + (item.speaker || item.speaker_id || '?') + ')</span>';
    const right = document.createElement('div'); right.className = 'small mono';
    const s = Number(item.start || 0).toFixed(2), e = Number(item.end || 0).toFixed(2);
    right.textContent = '@ ' + s + 's – ' + e + 's';
    title.appendChild(left); title.appendChild(right);

    const row = document.createElement('div'); row.className = 'row';
    const audio = document.createElement('audio'); audio.controls = true; audio.preload = 'metadata';
    audio.src = item.clip;
    const text = document.createElement('span');
    // Avoid quotes that could break HTML; payload already contains raw text.
    text.textContent = '  ' + (item.text || '');
    row.appendChild(audio); row.appendChild(text);

    card.appendChild(title); card.appendChild(row); container.appendChild(card);
  });
}
render();
</script>
</body>
</html>
